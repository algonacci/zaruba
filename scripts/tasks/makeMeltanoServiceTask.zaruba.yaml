tasks: 
 
  makeMeltanoServiceTask:
    extend: core.makeServiceTask
    inputs:
      - generatorServiceLocation
      - generatorServiceName
      - generatorServiceEnvs
      - generatorServicePorts
      - generatorTaskDependencies
      - generatorServiceDockerImageName
      - generatorServiceDockerContainerName
    config:
      registerRunner: false
      beforeStart: |
        mkdir -p "{{ .GetConfig "serviceLocation" }}"
      afterStart: |
        # dunno, but seemingly it won't work with 
        pip install meltano
        cd "{{ .GetConfig "serviceLocation" }}"
        pipenv run meltano init app
        '{{ .ZarubaBin }}' util generate '{{ .GetEnv "ZARUBA_HOME" }}/templates/meltanoApp' ./app '{}'
        chmod 755 app/start.sh
      templateLocation: '{{ .GetEnv "ZARUBA_HOME" }}/templates/task/service/meltano'

