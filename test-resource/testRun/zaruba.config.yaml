environments:
  general:
    natsUrl: nats://0.0.0.0:4222
    getMessageEvent: foo
    sendMessageEvent: bar
  services:
    gateway:
      port: 3000

components:
  greeting-lib:
    type: library
    location: "./libraries/greeting-lib"
  gateway:
    type: service
    origin: git@github.com:state-alchemists/zaruba-gateway-example.git
    branch: master
    location: "./services/gateway"
    start: npm install && node start
    readinessCheck: curl 0.0.0.0:${port}
  greeter:
    type: service
    origin: git@github.com:goFrendiAsgard/zaruba-service-example.git
    branch: master
    location: "./services/greeter"
    start: npm install && node start
  nats:
    type: container
    run: docker run --name nats -p 4222:4222 -p 6222:6222 -p 8222:8222 -d nats
    containerName: nats
    readinessCheck: curl 0.0.0.0:8222

links:
  ./libraries/greeting-lib: 
    - ./services/greeter/greeting-lib
    - ./services/gateway/greeting-lib
  
executions:
  - nats
  - greeter
  - gateway