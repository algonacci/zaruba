tasks:

  testPlayground:
    dependencies:
      - testStopContainers

  testSyncEnv:
    location: ../../../../playground
    extend: zrbRunShellScript 
    dependencies:
      - testAddComponents
    configRef: playgroundTest
    config:
      start: |
        touch .env
        ../zaruba please syncEnv

  testRemoveContainers:
    location: ../../../../playground
    extend: zrbRunShellScript 
    dependencies:
      - testSyncEnv
    configRef: playgroundTest
    config:
      start: |
        ../zaruba please removeContainers

  testStart:
    location: ../../../../playground
    extend: zrbRunShellScript 
    dependencies:
      - testRemoveContainers
    configRef: playgroundTest
    config:
      start: |
        ../zaruba please start -t

  testStartContainers:
    location: ../../../../playground
    extend: zrbRunShellScript 
    dependencies:
      - testStart
    configRef: playgroundTest
    config:
      start: |
        ../zaruba please startContainers -t
        echo "the containers are still running in the background"

  testFastApi:
    location: ../../../../playground
    extend: zrbRunShellScript 
    dependencies:
      - testStartContainers
    configRef: playgroundTest
    config:
      start: |
        sleep 5
        python "{{ .GetPath "test_fastapi.py" }}"

  testStopContainers:
    location: ../../../../playground
    extend: zrbRunShellScript 
    dependencies:
      - testFastApi
    configRef: playgroundTest
    config:
      start: |
        ../zaruba please stopContainers

