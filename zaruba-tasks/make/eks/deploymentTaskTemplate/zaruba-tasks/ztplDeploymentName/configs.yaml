configs:

  ztplDeploymentName:
    pulumiStack: '{{ if .GetValue "pulumiStack" }}{{ .GetValue "pulumiStack" }}{{ else }}dev{{ end }}'
    pulumiSelectStack: |
      PULUMI_STACK='{{ .GetConfig "pulumiStack" }}'
      pulumi stack select "${PULUMI_STACK}" || pulumi stack init "${PULUMI_STACK}"

  deployZtplDeploymentName:
    start: |
      {{ .GetConfig "pulumiSelectStack" }}
      pulumi up -y
      aws eks --region us-east-2 update-kubeconfig --name $(pulumi stack output cluster-name)

  destroyZtplDeploymentName: 
    start: |
      {{ .GetConfig "pulumiSelectStack" }}
      pulumi destroy -y

  prepareZtplDeploymentName: {}
  