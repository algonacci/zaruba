tasks:
 
  makeKafkaApp:
    icon: ðŸª 
    extend: makeApp
    inputs:
      - appDirectory
    config:
      templateLocations: |
        [
          "{{ .ZarubaHome }}/zaruba-tasks/make/kafka/appTemplate"
        ]

  addKafka:
    icon: ðŸª 
    extend: makeContainerAppRunner
    dependencies:
      - makeKafkaApp
    inputs:
      - appDirectory
      - appDependencies
      - appName
      - appEnvs
      - kafkaPorts
      - zookeeperPorts
      - appImageName
      - appContainerName
    config:
      appIcon: ðŸª 
      appKafkaPorts: '{{ .GetValue "kafkaPorts" }}'
      appZookeeperPorts: '{{ .GetValue "zookeeperPorts" }}'
      defaultAppDirectory: '{{ .ProjectName }}Kafka'
      templateLocations: |
        [
          "{{ .ZarubaHome }}/zaruba-tasks/make/_task/appRunner/_base/template",
          "{{ .ZarubaHome }}/zaruba-tasks/make/_task/appRunner/container/template",
          "{{ .ZarubaHome }}/zaruba-tasks/make/kafka/taskTemplate"
        ]
      _prepareVariables: |
        _ZRB_APP_KAFKA_PORTS='{{ .GetConfig "appKafkaPorts" }}'
        _ZRB_APP_ZOOKEEPER_PORTS='{{ .GetConfig "appZookeeperPorts" }}'
        . "{{ .ZarubaHome }}/zaruba-tasks/make/kafka/bash/prepareVariables.sh"
      _prepareReplacementMap: |
        . "{{ .ZarubaHome }}/zaruba-tasks/make/kafka/bash/setReplacementMap.sh"