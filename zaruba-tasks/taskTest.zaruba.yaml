tasks:

  testCore:
    icon: 游눌
    location: ../
    extend: core.runShellScript
    configRef: mainTest
    config:
      start: |
        ZARUBA_HOME=""
        mkdir -p ./coverage
        rm -f ./test-resources/log.zaruba.csv
        go test -v ./... --race -coverprofile=./coverage/profile.out -covermode=atomic
        go tool cover -html=./coverage/profile.out -o ./coverage/coverage.html


  testShowVersion:
    icon: 游눌
    location: ../
    dependencies:
      - build
    extend: core.runShellScript
    configRef: mainTest
    config:
      start: ./zaruba please showVersion 


  testCoreTask:
    icon: 游눌
    location: ../
    dependencies:
      - build
      - testShowVersion


  test:
    icon: 游눌
    dependencies:
      - testCore
      - testCoreTask
      - testPlayground
      - testPushImage
      - testHelmInstall
      - testHelmUninstall
      - stopContainerRegistry