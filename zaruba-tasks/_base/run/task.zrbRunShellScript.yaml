tasks:

  zrbRunShellScript:
    icon: üêö
    description: |
      Run shell script
      Common configs:
        start : Start script
    private: true
    extend: zrbRunScript
    configs:
      strictMode: true
      includeShellUtil: true
      initShellConfigVariables: false
      initShellConfigMapVariable: false
      initShellEnvMapVariable: false
      _initShell: |
        {{ if .Util.Bool.IsTrue (.GetConfig "strictMode") }}set -e{{ else }}set +e{{ end }}
        {{ if .Util.Bool.IsTrue (.GetConfig "includeShellUtil") }}. {{ .ZarubaHome }}/zaruba-tasks/_base/run/bash/shellUtil.sh{{ else }}{{ "" -}}{{ end }}
        {{ $d := .Decoration -}}
        {{ $d.ToShellVariables }}
        {{ if .Util.Bool.IsTrue (.GetConfig "initShellConfigVariables") }}{{ .GetConfigsAsShellVariables "^[^_].*$" "_ZRB_CFG" }}{{ else }}{{ "" -}}{{ end }}
        {{ if .Util.Bool.IsTrue (.GetConfig "initShellConfigMapVariable") }}_ZRB_CONFIG_MAP={{ .Util.Str.SingleQuote (.Util.Json.FromStringDict (.GetConfigs "^[^_].*$")) }}{{ else }}{{ "" -}}{{ end }}
        {{ if .Util.Bool.IsTrue (.GetConfig "initShellEnvMapVariable") }}_ZRB_ENV_MAP={{ .Util.Str.SingleQuote (.Util.Json.FromStringDict (.GetEnvs)) }}{{ else }}{{ "" -}}{{ end }}
      _setup: '{{ .Util.Str.Trim (.GetConfig "_initShell") "\n" }}'
      start: "echo hello world"