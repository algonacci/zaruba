configs:

  zrbPulumi:
    pulumiStack: '{{ if .GetValue "pulumiStack" }}{{ .GetValue "pulumiStack" }}{{ else }}dev{{ end }}'
    pulumiUseLocalBackend: '{{ .GetValue "pulumiUseLocalBackend" }}'
    pulumiBackendUrl: ''
    _preparePulumi: |
      {{ if .Util.Bool.IsTrue (.GetConfig "pulumiUseLocalBackend") -}}
      mkdir -p ./pulumiLock
      PULUMI_BACKEND_URL="file://./pulumiLock"
      {{ else -}}
      PULUMI_BACKEND_URL=${ZARUBA_CONFIG_PLUMI_BACKEND_URL}
      {{ end -}}
      pulumi stack select "${ZARUBA_CONFIG_PULUMI_STACK}" || pulumi stack init "${ZARUBA_CONFIG_PULUMI_STACK}" 