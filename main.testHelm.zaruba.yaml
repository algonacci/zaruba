tasks:

  testHelmApply:
    icon: ðŸ’‰
    location: ./playground
    dependencies:
    - testMakeHelmCharts
    - testGeneratedService
    - runContainerRegistry
    extend: core.runShellScript 
    config:
      start: |
        set -e
        ZARUBA_HOME="$(realpath "..")"
        ../zaruba please makeServiceDeployment location=fibo
        ../zaruba please makeServiceDeployment location=myservice
        ../zaruba please updateEnv
        ../zaruba please helmApply kubeContext=docker-desktop helmEnv=default dockerEnv=default


  testHelmDestroy:
    icon: ðŸ’‰
    location: ./playground
    dependencies:
    - testHelmApply
    extend: core.runShellScript 
    config:
      start: |
        set -e
        ZARUBA_HOME="$(realpath "..")"
        ../zaruba please helmDestroy kubeContext=docker-desktop helmEnv=default dockerEnv=default


  stopContainerRegistry:
    icon: ðŸ’‰
    location: ./playground
    dependencies:
    - testPushImage
    - testHelmApply
    extend: core.runShellScript
    timeout: 1h
    config:
      start: |
        set -e
        docker stop containerRegistry
  
    